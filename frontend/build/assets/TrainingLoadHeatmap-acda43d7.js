import{j as e,f as R,h as T}from"./index-2d17be50.js";import{r as d}from"./vendor-c778fe58.js";import"./three-f2a0a5ce.js";const E=()=>{const[p,N]=d.useState([]),[i,b]=d.useState([]),[y,m]=d.useState(!0),[v,u]=d.useState(null),[f,w]=d.useState("14d");d.useEffect(()=>{(async()=>{try{m(!0),u(null);const a=(await R.getAllAthletes(1,50)).athletes||[];N(a);const c=await Promise.all(a.map(async o=>{try{const n=(await T.getBiometricDataByAthlete(o.id)).map(t=>({date:t.date,trainingLoad:t.training_load_pct||0,hrv:t.hrv_night,restingHr:t.resting_hr,sleepHours:t.sleep_duration_h})),D=n.length>0?n.reduce((t,l)=>t+l.trainingLoad,0)/n.length:0,g=n.filter(t=>t.hrv!==void 0&&t.hrv!==null).map(t=>t.hrv),S=g.length>0?g.reduce((t,l)=>t+l,0)/g.length:0,x=n.filter(t=>t.restingHr!==void 0&&t.restingHr!==null).map(t=>t.restingHr),M=x.length>0?x.reduce((t,l)=>t+l,0)/x.length:0,h=n.filter(t=>t.sleepHours!==void 0&&t.sleepHours!==null&&t.sleepHours>0).map(t=>t.sleepHours),A=h.length>0?h.reduce((t,l)=>t+l,0)/h.length:0;return{athlete:o,trainingDays:n,avgLoad:Math.round(D),avgHrv:Math.round(S),avgRestingHr:Math.round(M),avgSleep:Math.round(A*10)/10}}catch{return{athlete:o,trainingDays:[],avgLoad:0,avgHrv:0,avgRestingHr:0,avgSleep:0}}}));b(c)}catch{u("Failed to load training data")}finally{m(!1)}})()},[]);const j=s=>s>=90?"bg-red-500":s>=80?"bg-orange-500":s>=70?"bg-yellow-500":s>=60?"bg-green-400":s>=50?"bg-green-500":"bg-blue-500",L=s=>s>=90?"Very High":s>=80?"High":s>=70?"Moderate-High":s>=60?"Moderate":s>=50?"Low-Moderate":"Low";return y?e.jsx("div",{className:"space-y-8",children:e.jsx("div",{className:"card-enhanced p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading training data..."})]})})})}):v?e.jsx("div",{className:"space-y-8",children:e.jsx("div",{className:"card-enhanced p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-4xl mb-4",children:"⚠️"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Failed to Load Data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:v}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Retry"})]})})})}):p.length?e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"card-enhanced p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Training Load Overview"}),e.jsx("p",{className:"text-gray-600",children:"Monitor training intensity and recovery metrics"})]}),e.jsx("div",{className:"flex gap-2",children:["7d","14d","30d"].map(s=>e.jsx("button",{className:`px-3 py-1 text-sm rounded-full transition-colors ${f===s?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>w(s),children:s==="7d"?"7 Days":s==="14d"?"14 Days":"30 Days"},s))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Athletes"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(()=>{const s=i.reduce((r,a)=>r+a.avgLoad,0)/i.length;return isNaN(s)?0:Math.round(s)})(),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Training Load"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(()=>{const s=i.filter(a=>a.avgHrv>0),r=s.length>0?s.reduce((a,c)=>a+c.avgHrv,0)/s.length:0;return isNaN(r)?0:Math.round(r)})()}),e.jsx("div",{className:"text-sm text-gray-600",children:"Avg HRV"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[(()=>{const s=i.filter(a=>a.avgSleep>0),r=s.length>0?s.reduce((a,c)=>a+c.avgSleep,0)/s.length:0;return isNaN(r)?0:Math.round(r*10)/10})(),"h"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Sleep"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.athlete.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.athlete.sport})]}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.avgLoad>=80?"bg-red-100 text-red-800":s.avgLoad>=60?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:L(s.avgLoad)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"Training Load"}),e.jsxs("span",{children:[s.avgLoad,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-300 ${j(s.avgLoad)}`,style:{width:`${Math.min(s.avgLoad,100)}%`}})})]}),s.trainingDays.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recent Training"}),e.jsx("div",{className:"flex gap-1",children:s.trainingDays.slice(-7).map((r,a)=>e.jsx("div",{className:`w-6 h-6 rounded-sm ${j(r.trainingLoad)}`,title:`${r.date}: ${r.trainingLoad}% load`},a))})]}),s.trainingDays.length===0&&e.jsx("div",{className:"text-center py-4 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"No training data available"})})]},s.athlete.athlete_id))}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Training Load Intensity Scale"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Low (0-49%)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Moderate (50-69%)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"High (70-79%)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Very High (80-100%)"})]})]})]})]})}):e.jsx("div",{className:"space-y-8",children:e.jsx("div",{className:"card-enhanced p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:"📊"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Training Data Available"}),e.jsx("p",{className:"text-gray-600",children:"No athletes found in the system."})]})})})})};export{E as TrainingLoadHeatmap};
