function H(r,t,s){const n=Array.isArray(t)?t:[],i=Array.isArray(s)?s:[];if(n.length===0)return{type:"no_data",title:"ðŸ“Š No Data",cause:"No recent biometric data available",rec:"Please ensure data collection is active."};const e=n[n.length-1];i.reduce((c,a)=>(c[a.gene]=a.genotype,c),{});let o=!1,m=!1;if(t.length>=2){const c=t[t.length-2],a=Number(c.hrv_night??0),b=Number(e.hrv_night??0),d=Number(c.resting_hr??0),N=Number(e.resting_hr??0);o=a>0?(a-b)/a>.15:b<40,m=d>0?(N-d)/d>.05:N>70}else{const c=Number(e.hrv_night??0),a=Number(e.resting_hr??0);o=c<40,m=a>70}const g=Number(e.temp_trend_c??0)>=37,_=Number(e.spo2_night??0)>0?Number(e.spo2_night??0)<=94:!1,y=Number(e.deep_sleep_pct??0)>0?Number(e.deep_sleep_pct??0)<17:!1,v=Number(e.rem_sleep_pct??0)>0?Number(e.rem_sleep_pct??0)<16:!1;Number(e.sleep_duration_h??0)>0&&Number(e.sleep_duration_h??0)<7;const f=Number(e.resp_rate_night??0)>=17,A=e.sleep_onset_time&&new Date(`1970-01-01T${e.sleep_onset_time}:00`).getHours()>=23.5;return o&&m&&g&&_?{type:"inflammation",title:"âš ï¸ Inflammation/Illness Risk",cause:`HRVâ†“(${e.hrv_night}) + RHRâ†‘(${e.resting_hr}) + Tempâ†‘(${e.temp_trend_c}) + SpOâ‚‚â†“(${e.spo2_night})`,rec:"Prioritize rest, hydration, anti-inflammatory nutrition. Monitor temperature closely."}:o&&y&&A?{type:"circadian",title:"ðŸŒ™ Circadian Misalignment",cause:`HRVâ†“ + Deep Sleepâ†“(${e.deep_sleep_pct}%) + Late Sleep`,rec:"Advance bedtime by 45min, increase morning light exposure, avoid screens after 9PM."}:o&&v&&!g?{type:"nutrition",title:"ðŸ¥— Possible Nutrient Gap",cause:`HRVâ†“ + REMâ†“(${e.rem_sleep_pct}%) with stable temperature`,rec:"Check iron, magnesium, omega-3, B12 status. Increase nutrient-dense foods."}:_&&f?{type:"airway",title:"ðŸŒ¬ï¸ Airway/Respiratory Stress",cause:`SpOâ‚‚=${e.spo2_night}% + Resp Rate=${e.resp_rate_night}/min`,rec:"Evaluate sleep environment, nasal breathing. Consider air quality assessment."}:{type:"green",title:"ðŸŸ¢ Optimal Recovery State",cause:"All metrics within target ranges",rec:"Maintain current training and recovery protocols."}}const M=(r,t,s)=>{const i=s.filter(e=>e.athlete_id!==t).map(e=>e[r]).filter(Boolean);return i.length>0?Number((i.reduce((e,o)=>e+o,0)/i.length).toFixed(1)):0};function T(r){const t=Number(r?.recovery_score??0);if(t>0&&t<=100)return Math.round(t);const s=(l,p,u)=>Math.max(p,Math.min(u,l)),n=l=>{if(!l||l==="00:00")return null;const p=l.split(":");if(p.length<2)return null;const u=parseInt(p[0],10),h=parseInt(p[1],10);return isNaN(u)||isNaN(h)?null:u*60+h},i=()=>{const l=typeof r.sleep_duration_h=="number"?Number(r.sleep_duration_h):0;if(l&&l>0)return l;const p=n(r.sleep_onset_time),u=n(r.wake_time);if(p!==null&&u!==null){let h=u-p;return h<0&&(h+=24*60),Math.max(0,h)/60}return 0},e=Number(r.hrv_night??0),o=Number(r.resting_hr??0),m=i(),g=Number(r.spo2_night??0),_=Number(r.deep_sleep_pct??0),y=Number(r.rem_sleep_pct??0),v=e>0?s((e-35)/(80-35),0,1):0,f=o>0?s((75-o)/(75-45),0,1):0,A=m>0?s((m-6)/(8-6),0,1):0,c=g>0?s((g-94)/(99-94),0,1):0,a=20,b=18,d=_>0?s(_/a,0,1):0,N=y>0?s(y/b,0,1):0,R=(d+N)/2,w=.7*A+.3*R,C=v*.35+f*.25+w*.25+c*.15;return Math.round(C*100)}function E(r){const t=[],n=(Array.isArray(r)?r:[]).reduce((i,e)=>(i[e.gene]=e.genotype,i),{});return n.PER3==="long"?t.push({gene:"PER3 (Long variant)",trait:"Natural night owl tendency",recommendation:"Allow later bedtimes when possible, prioritize consistent wake times, use bright light therapy in morning"}):n.PER3==="short"&&t.push({gene:"PER3 (Short variant)",trait:"Natural early bird tendency",recommendation:"Optimize early morning training, avoid late evening intense exercise, maintain regular early bedtime"}),n.CLOCK==="AA"&&t.push({gene:"CLOCK (AA genotype)",trait:"Enhanced circadian sensitivity",recommendation:"Maintain strict sleep schedule, minimize blue light exposure 2h before bed, prioritize sleep environment optimization"}),n.ACTN3==="XX"?t.push({gene:"ACTN3 (XX genotype)",trait:"Enhanced endurance capacity",recommendation:"Focus on aerobic base building, longer recovery periods between high-intensity sessions, emphasize mitochondrial health"}):n.ACTN3==="RR"&&t.push({gene:"ACTN3 (RR genotype)",trait:"Enhanced power/sprint capacity",recommendation:"Optimize explosive training, shorter but more intense sessions, focus on neuromuscular recovery"}),t}export{E as a,M as b,T as c,H as g};
